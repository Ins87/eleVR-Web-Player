function _classCallCheck(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}!function(t,a){if("object"==typeof exports&&"object"==typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var e=a();for(var n in e)("object"==typeof exports?exports:t)[n]=e[n]}}(this,function(){return function(t){function a(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}var e={};return a.m=t,a.c=e,a.p="",a(0)}([function(t,a,e){a.glMatrix=e(1),a.mat2=e(2),a.mat2d=e(3),a.mat3=e(4),a.mat4=e(5),a.quat=e(6),a.vec2=e(9),a.vec3=e(7),a.vec4=e(8)},function(t,a){var e={};e.EPSILON=1e-6,e.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,e.RANDOM=Math.random,e.ENABLE_SIMD=!1,e.SIMD_AVAILABLE=e.ARRAY_TYPE===Float32Array&&"SIMD"in this,e.USE_SIMD=e.ENABLE_SIMD&&e.SIMD_AVAILABLE,e.setMatrixArrayType=function(t){e.ARRAY_TYPE=t};var n=Math.PI/180;e.toRadian=function(t){return t*n},e.equals=function(t,a){return Math.abs(t-a)<=e.EPSILON*Math.max(1,Math.abs(t),Math.abs(a))},t.exports=e},function(t,a,e){var n=e(1),r={};r.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.clone=function(t){var a=new n.ARRAY_TYPE(4);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a},r.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.fromValues=function(t,a,e,r){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=a,o[2]=e,o[3]=r,o},r.set=function(t,a,e,n,r){return t[0]=a,t[1]=e,t[2]=n,t[3]=r,t},r.transpose=function(t,a){if(t===a){var e=a[1];t[1]=a[2],t[2]=e}else t[0]=a[0],t[1]=a[2],t[2]=a[1],t[3]=a[3];return t},r.invert=function(t,a){var e=a[0],n=a[1],r=a[2],o=a[3],i=e*o-r*n;return i?(i=1/i,t[0]=o*i,t[1]=-n*i,t[2]=-r*i,t[3]=e*i,t):null},r.adjoint=function(t,a){var e=a[0];return t[0]=a[3],t[1]=-a[1],t[2]=-a[2],t[3]=e,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=e[0],l=e[1],u=e[2],h=e[3];return t[0]=n*s+o*l,t[1]=r*s+i*l,t[2]=n*u+o*h,t[3]=r*u+i*h,t},r.mul=r.multiply,r.rotate=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=Math.sin(e),l=Math.cos(e);return t[0]=n*l+o*s,t[1]=r*l+i*s,t[2]=n*-s+o*l,t[3]=r*-s+i*l,t},r.scale=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=e[0],l=e[1];return t[0]=n*s,t[1]=r*s,t[2]=o*l,t[3]=i*l,t},r.fromRotation=function(t,a){var e=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=e,t[2]=-e,t[3]=n,t},r.fromScaling=function(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=a[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},r.LDU=function(t,a,e,n){return t[2]=n[2]/n[0],e[0]=n[0],e[1]=n[1],e[3]=n[3]-t[2]*e[1],[t,a,e]},r.add=function(t,a,e){return t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t[3]=a[3]+e[3],t},r.subtract=function(t,a,e){return t[0]=a[0]-e[0],t[1]=a[1]-e[1],t[2]=a[2]-e[2],t[3]=a[3]-e[3],t},r.sub=r.subtract,r.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]},r.equals=function(t,a){var e=t[0],r=t[1],o=t[2],i=t[3],s=a[0],l=a[1],u=a[2],h=a[3];return Math.abs(e-s)<=n.EPSILON*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(r-l)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-u)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(i-h)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))},r.multiplyScalar=function(t,a,e){return t[0]=a[0]*e,t[1]=a[1]*e,t[2]=a[2]*e,t[3]=a[3]*e,t},r.multiplyScalarAndAdd=function(t,a,e,n){return t[0]=a[0]+e[0]*n,t[1]=a[1]+e[1]*n,t[2]=a[2]+e[2]*n,t[3]=a[3]+e[3]*n,t},t.exports=r},function(t,a,e){var n=e(1),r={};r.create=function(){var t=new n.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.clone=function(t){var a=new n.ARRAY_TYPE(6);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a},r.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.fromValues=function(t,a,e,r,o,i){var s=new n.ARRAY_TYPE(6);return s[0]=t,s[1]=a,s[2]=e,s[3]=r,s[4]=o,s[5]=i,s},r.set=function(t,a,e,n,r,o,i){return t[0]=a,t[1]=e,t[2]=n,t[3]=r,t[4]=o,t[5]=i,t},r.invert=function(t,a){var e=a[0],n=a[1],r=a[2],o=a[3],i=a[4],s=a[5],l=e*o-n*r;return l?(l=1/l,t[0]=o*l,t[1]=-n*l,t[2]=-r*l,t[3]=e*l,t[4]=(r*s-o*i)*l,t[5]=(n*i-e*s)*l,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=a[4],l=a[5],u=e[0],h=e[1],c=e[2],M=e[3],f=e[4],m=e[5];return t[0]=n*u+o*h,t[1]=r*u+i*h,t[2]=n*c+o*M,t[3]=r*c+i*M,t[4]=n*f+o*m+s,t[5]=r*f+i*m+l,t},r.mul=r.multiply,r.rotate=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=a[4],l=a[5],u=Math.sin(e),h=Math.cos(e);return t[0]=n*h+o*u,t[1]=r*h+i*u,t[2]=n*-u+o*h,t[3]=r*-u+i*h,t[4]=s,t[5]=l,t},r.scale=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=a[4],l=a[5],u=e[0],h=e[1];return t[0]=n*u,t[1]=r*u,t[2]=o*h,t[3]=i*h,t[4]=s,t[5]=l,t},r.translate=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=a[4],l=a[5],u=e[0],h=e[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=i,t[4]=n*u+o*h+s,t[5]=r*u+i*h+l,t},r.fromRotation=function(t,a){var e=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=e,t[2]=-e,t[3]=n,t[4]=0,t[5]=0,t},r.fromScaling=function(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=a[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=a[0],t[5]=a[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},r.add=function(t,a,e){return t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t[3]=a[3]+e[3],t[4]=a[4]+e[4],t[5]=a[5]+e[5],t},r.subtract=function(t,a,e){return t[0]=a[0]-e[0],t[1]=a[1]-e[1],t[2]=a[2]-e[2],t[3]=a[3]-e[3],t[4]=a[4]-e[4],t[5]=a[5]-e[5],t},r.sub=r.subtract,r.multiplyScalar=function(t,a,e){return t[0]=a[0]*e,t[1]=a[1]*e,t[2]=a[2]*e,t[3]=a[3]*e,t[4]=a[4]*e,t[5]=a[5]*e,t},r.multiplyScalarAndAdd=function(t,a,e,n){return t[0]=a[0]+e[0]*n,t[1]=a[1]+e[1]*n,t[2]=a[2]+e[2]*n,t[3]=a[3]+e[3]*n,t[4]=a[4]+e[4]*n,t[5]=a[5]+e[5]*n,t},r.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]},r.equals=function(t,a){var e=t[0],r=t[1],o=t[2],i=t[3],s=t[4],l=t[5],u=a[0],h=a[1],c=a[2],M=a[3],f=a[4],m=a[5];return Math.abs(e-u)<=n.EPSILON*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(r-h)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(o-c)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(i-M)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(s-f)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(l-m)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))},t.exports=r},function(t,a,e){var n=e(1),r={};r.create=function(){var t=new n.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat4=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[4],t[4]=a[5],t[5]=a[6],t[6]=a[8],t[7]=a[9],t[8]=a[10],t},r.clone=function(t){var a=new n.ARRAY_TYPE(9);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a},r.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t},r.fromValues=function(t,a,e,r,o,i,s,l,u){var h=new n.ARRAY_TYPE(9);return h[0]=t,h[1]=a,h[2]=e,h[3]=r,h[4]=o,h[5]=i,h[6]=s,h[7]=l,h[8]=u,h},r.set=function(t,a,e,n,r,o,i,s,l,u){return t[0]=a,t[1]=e,t[2]=n,t[3]=r,t[4]=o,t[5]=i,t[6]=s,t[7]=l,t[8]=u,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,a){if(t===a){var e=a[1],n=a[2],r=a[5];t[1]=a[3],t[2]=a[6],t[3]=e,t[5]=a[7],t[6]=n,t[7]=r}else t[0]=a[0],t[1]=a[3],t[2]=a[6],t[3]=a[1],t[4]=a[4],t[5]=a[7],t[6]=a[2],t[7]=a[5],t[8]=a[8];return t},r.invert=function(t,a){var e=a[0],n=a[1],r=a[2],o=a[3],i=a[4],s=a[5],l=a[6],u=a[7],h=a[8],c=h*i-s*u,M=-h*o+s*l,f=u*o-i*l,m=e*c+n*M+r*f;return m?(m=1/m,t[0]=c*m,t[1]=(-h*n+r*u)*m,t[2]=(s*n-r*i)*m,t[3]=M*m,t[4]=(h*e-r*l)*m,t[5]=(-s*e+r*o)*m,t[6]=f*m,t[7]=(-u*e+n*l)*m,t[8]=(i*e-n*o)*m,t):null},r.adjoint=function(t,a){var e=a[0],n=a[1],r=a[2],o=a[3],i=a[4],s=a[5],l=a[6],u=a[7],h=a[8];return t[0]=i*h-s*u,t[1]=r*u-n*h,t[2]=n*s-r*i,t[3]=s*l-o*h,t[4]=e*h-r*l,t[5]=r*o-e*s,t[6]=o*u-i*l,t[7]=n*l-e*u,t[8]=e*i-n*o,t},r.determinant=function(t){var a=t[0],e=t[1],n=t[2],r=t[3],o=t[4],i=t[5],s=t[6],l=t[7],u=t[8];return a*(u*o-i*l)+e*(-u*r+i*s)+n*(l*r-o*s)},r.multiply=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=a[4],l=a[5],u=a[6],h=a[7],c=a[8],M=e[0],f=e[1],m=e[2],d=e[3],x=e[4],S=e[5],v=e[6],I=e[7],D=e[8];return t[0]=M*n+f*i+m*u,t[1]=M*r+f*s+m*h,t[2]=M*o+f*l+m*c,t[3]=d*n+x*i+S*u,t[4]=d*r+x*s+S*h,t[5]=d*o+x*l+S*c,t[6]=v*n+I*i+D*u,t[7]=v*r+I*s+D*h,t[8]=v*o+I*l+D*c,t},r.mul=r.multiply,r.translate=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=a[4],l=a[5],u=a[6],h=a[7],c=a[8],M=e[0],f=e[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=i,t[4]=s,t[5]=l,t[6]=M*n+f*i+u,t[7]=M*r+f*s+h,t[8]=M*o+f*l+c,t},r.rotate=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=a[4],l=a[5],u=a[6],h=a[7],c=a[8],M=Math.sin(e),f=Math.cos(e);return t[0]=f*n+M*i,t[1]=f*r+M*s,t[2]=f*o+M*l,t[3]=f*i-M*n,t[4]=f*s-M*r,t[5]=f*l-M*o,t[6]=u,t[7]=h,t[8]=c,t},r.scale=function(t,a,e){var n=e[0],r=e[1];return t[0]=n*a[0],t[1]=n*a[1],t[2]=n*a[2],t[3]=r*a[3],t[4]=r*a[4],t[5]=r*a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t},r.fromTranslation=function(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=a[0],t[7]=a[1],t[8]=1,t},r.fromRotation=function(t,a){var e=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=e,t[2]=0,t[3]=-e,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=a[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=0,t[3]=a[2],t[4]=a[3],t[5]=0,t[6]=a[4],t[7]=a[5],t[8]=1,t},r.fromQuat=function(t,a){var e=a[0],n=a[1],r=a[2],o=a[3],i=e+e,s=n+n,l=r+r,u=e*i,h=n*i,c=n*s,M=r*i,f=r*s,m=r*l,d=o*i,x=o*s,S=o*l;return t[0]=1-c-m,t[3]=h-S,t[6]=M+x,t[1]=h+S,t[4]=1-u-m,t[7]=f-d,t[2]=M-x,t[5]=f+d,t[8]=1-u-c,t},r.normalFromMat4=function(t,a){var e=a[0],n=a[1],r=a[2],o=a[3],i=a[4],s=a[5],l=a[6],u=a[7],h=a[8],c=a[9],M=a[10],f=a[11],m=a[12],d=a[13],x=a[14],S=a[15],v=e*s-n*i,I=e*l-r*i,D=e*u-o*i,F=n*l-r*s,g=n*u-o*s,b=r*u-o*l,p=h*d-c*m,w=h*x-M*m,E=h*S-f*m,y=c*x-M*d,R=c*S-f*d,P=M*S-f*x,z=v*P-I*R+D*y+F*E-g*w+b*p;return z?(z=1/z,t[0]=(s*P-l*R+u*y)*z,t[1]=(l*E-i*P-u*w)*z,t[2]=(i*R-s*E+u*p)*z,t[3]=(r*R-n*P-o*y)*z,t[4]=(e*P-r*E+o*w)*z,t[5]=(n*E-e*R-o*p)*z,t[6]=(d*b-x*g+S*F)*z,t[7]=(x*D-m*b-S*I)*z,t[8]=(m*g-d*D+S*v)*z,t):null},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},r.add=function(t,a,e){return t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t[3]=a[3]+e[3],t[4]=a[4]+e[4],t[5]=a[5]+e[5],t[6]=a[6]+e[6],t[7]=a[7]+e[7],t[8]=a[8]+e[8],t},r.subtract=function(t,a,e){return t[0]=a[0]-e[0],t[1]=a[1]-e[1],t[2]=a[2]-e[2],t[3]=a[3]-e[3],t[4]=a[4]-e[4],t[5]=a[5]-e[5],t[6]=a[6]-e[6],t[7]=a[7]-e[7],t[8]=a[8]-e[8],t},r.sub=r.subtract,r.multiplyScalar=function(t,a,e){return t[0]=a[0]*e,t[1]=a[1]*e,t[2]=a[2]*e,t[3]=a[3]*e,t[4]=a[4]*e,t[5]=a[5]*e,t[6]=a[6]*e,t[7]=a[7]*e,t[8]=a[8]*e,t},r.multiplyScalarAndAdd=function(t,a,e,n){return t[0]=a[0]+e[0]*n,t[1]=a[1]+e[1]*n,t[2]=a[2]+e[2]*n,t[3]=a[3]+e[3]*n,t[4]=a[4]+e[4]*n,t[5]=a[5]+e[5]*n,t[6]=a[6]+e[6]*n,t[7]=a[7]+e[7]*n,t[8]=a[8]+e[8]*n,t},r.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]},r.equals=function(t,a){var e=t[0],r=t[1],o=t[2],i=t[3],s=t[4],l=t[5],u=t[6],h=t[7],c=t[8],M=a[0],f=a[1],m=a[2],d=a[3],x=a[4],S=a[5],v=t[6],I=a[7],D=a[8];return Math.abs(e-M)<=n.EPSILON*Math.max(1,Math.abs(e),Math.abs(M))&&Math.abs(r-f)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(o-m)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(i-d)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(s-x)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(l-S)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(u-v)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-I)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(c-D)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(D))},t.exports=r},function(t,a,e){var n=e(1),r={scalar:{},SIMD:{}};r.create=function(){var t=new n.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.clone=function(t){var a=new n.ARRAY_TYPE(16);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},r.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},r.fromValues=function(t,a,e,r,o,i,s,l,u,h,c,M,f,m,d,x){var S=new n.ARRAY_TYPE(16);return S[0]=t,S[1]=a,S[2]=e,S[3]=r,S[4]=o,S[5]=i,S[6]=s,S[7]=l,S[8]=u,S[9]=h,S[10]=c,S[11]=M,S[12]=f,S[13]=m,S[14]=d,S[15]=x,S},r.set=function(t,a,e,n,r,o,i,s,l,u,h,c,M,f,m,d,x){return t[0]=a,t[1]=e,t[2]=n,t[3]=r,t[4]=o,t[5]=i,t[6]=s,t[7]=l,t[8]=u,t[9]=h,t[10]=c,t[11]=M,t[12]=f,t[13]=m,t[14]=d,t[15]=x,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.scalar.transpose=function(t,a){if(t===a){var e=a[1],n=a[2],r=a[3],o=a[6],i=a[7],s=a[11];t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=e,t[6]=a[9],t[7]=a[13],t[8]=n,t[9]=o,t[11]=a[14],t[12]=r,t[13]=i,t[14]=s}else t[0]=a[0],t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=a[1],t[5]=a[5],t[6]=a[9],t[7]=a[13],t[8]=a[2],t[9]=a[6],t[10]=a[10],t[11]=a[14],t[12]=a[3],t[13]=a[7],t[14]=a[11],t[15]=a[15];return t},r.SIMD.transpose=function(t,a){var e,n,r,o,i,s,l,u,h,c;return e=SIMD.Float32x4.load(a,0),n=SIMD.Float32x4.load(a,4),r=SIMD.Float32x4.load(a,8),o=SIMD.Float32x4.load(a,12),i=SIMD.Float32x4.shuffle(e,n,0,1,4,5),s=SIMD.Float32x4.shuffle(r,o,0,1,4,5),l=SIMD.Float32x4.shuffle(i,s,0,2,4,6),u=SIMD.Float32x4.shuffle(i,s,1,3,5,7),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,u),i=SIMD.Float32x4.shuffle(e,n,2,3,6,7),s=SIMD.Float32x4.shuffle(r,o,2,3,6,7),h=SIMD.Float32x4.shuffle(i,s,0,2,4,6),c=SIMD.Float32x4.shuffle(i,s,1,3,5,7),SIMD.Float32x4.store(t,8,h),SIMD.Float32x4.store(t,12,c),t},r.transpose=n.USE_SIMD?r.SIMD.transpose:r.scalar.transpose,r.scalar.invert=function(t,a){var e=a[0],n=a[1],r=a[2],o=a[3],i=a[4],s=a[5],l=a[6],u=a[7],h=a[8],c=a[9],M=a[10],f=a[11],m=a[12],d=a[13],x=a[14],S=a[15],v=e*s-n*i,I=e*l-r*i,D=e*u-o*i,F=n*l-r*s,g=n*u-o*s,b=r*u-o*l,p=h*d-c*m,w=h*x-M*m,E=h*S-f*m,y=c*x-M*d,R=c*S-f*d,P=M*S-f*x,z=v*P-I*R+D*y+F*E-g*w+b*p;return z?(z=1/z,t[0]=(s*P-l*R+u*y)*z,t[1]=(r*R-n*P-o*y)*z,t[2]=(d*b-x*g+S*F)*z,t[3]=(M*g-c*b-f*F)*z,t[4]=(l*E-i*P-u*w)*z,t[5]=(e*P-r*E+o*w)*z,t[6]=(x*D-m*b-S*I)*z,t[7]=(h*b-M*D+f*I)*z,t[8]=(i*R-s*E+u*p)*z,t[9]=(n*E-e*R-o*p)*z,t[10]=(m*g-d*D+S*v)*z,t[11]=(c*D-h*g-f*v)*z,t[12]=(s*w-i*y-l*p)*z,t[13]=(e*y-n*w+r*p)*z,t[14]=(d*I-m*F-x*v)*z,t[15]=(h*F-c*I+M*v)*z,t):null},r.SIMD.invert=function(t,a){var e,n,r,o,i,s,l,u,h,c,M=SIMD.Float32x4.load(a,0),f=SIMD.Float32x4.load(a,4),m=SIMD.Float32x4.load(a,8),d=SIMD.Float32x4.load(a,12);return i=SIMD.Float32x4.shuffle(M,f,0,1,4,5),n=SIMD.Float32x4.shuffle(m,d,0,1,4,5),e=SIMD.Float32x4.shuffle(i,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,i,1,3,5,7),i=SIMD.Float32x4.shuffle(M,f,2,3,6,7),o=SIMD.Float32x4.shuffle(m,d,2,3,6,7),r=SIMD.Float32x4.shuffle(i,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,i,1,3,5,7),i=SIMD.Float32x4.mul(r,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.mul(n,i),l=SIMD.Float32x4.mul(e,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,i),s),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,i),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),i=SIMD.Float32x4.mul(n,r),i=SIMD.Float32x4.swizzle(i,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),s),h=SIMD.Float32x4.mul(e,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,i)),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,i),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),i=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,3,0,1),o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),r=SIMD.Float32x4.swizzle(r,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),s),u=SIMD.Float32x4.mul(e,i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(r,i)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,i),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.mul(e,n),i=SIMD.Float32x4.swizzle(i,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),u),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,i),h),i=SIMD.Float32x4.swizzle(i,2,3,0,1),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),u),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(r,i)),i=SIMD.Float32x4.mul(e,o),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,i)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),u),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,i),l),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(n,i)),i=SIMD.Float32x4.mul(e,r),i=SIMD.Float32x4.swizzle(i,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),l),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(n,i)),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,i)),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,i),h),c=SIMD.Float32x4.mul(e,s),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c),c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c),i=SIMD.Float32x4.reciprocalApproximation(c),c=SIMD.Float32x4.sub(SIMD.Float32x4.add(i,i),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(i,i))),(c=SIMD.Float32x4.swizzle(c,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(c,s)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(c,l)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(c,u)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(c,h)),t):null},r.invert=n.USE_SIMD?r.SIMD.invert:r.scalar.invert,r.scalar.adjoint=function(t,a){var e=a[0],n=a[1],r=a[2],o=a[3],i=a[4],s=a[5],l=a[6],u=a[7],h=a[8],c=a[9],M=a[10],f=a[11],m=a[12],d=a[13],x=a[14],S=a[15];return t[0]=s*(M*S-f*x)-c*(l*S-u*x)+d*(l*f-u*M),t[1]=-(n*(M*S-f*x)-c*(r*S-o*x)+d*(r*f-o*M)),t[2]=n*(l*S-u*x)-s*(r*S-o*x)+d*(r*u-o*l),t[3]=-(n*(l*f-u*M)-s*(r*f-o*M)+c*(r*u-o*l)),t[4]=-(i*(M*S-f*x)-h*(l*S-u*x)+m*(l*f-u*M)),t[5]=e*(M*S-f*x)-h*(r*S-o*x)+m*(r*f-o*M),t[6]=-(e*(l*S-u*x)-i*(r*S-o*x)+m*(r*u-o*l)),t[7]=e*(l*f-u*M)-i*(r*f-o*M)+h*(r*u-o*l),t[8]=i*(c*S-f*d)-h*(s*S-u*d)+m*(s*f-u*c),t[9]=-(e*(c*S-f*d)-h*(n*S-o*d)+m*(n*f-o*c)),t[10]=e*(s*S-u*d)-i*(n*S-o*d)+m*(n*u-o*s),t[11]=-(e*(s*f-u*c)-i*(n*f-o*c)+h*(n*u-o*s)),t[12]=-(i*(c*x-M*d)-h*(s*x-l*d)+m*(s*M-l*c)),t[13]=e*(c*x-M*d)-h*(n*x-r*d)+m*(n*M-r*c),t[14]=-(e*(s*x-l*d)-i*(n*x-r*d)+m*(n*l-r*s)),t[15]=e*(s*M-l*c)-i*(n*M-r*c)+h*(n*l-r*s),t},r.SIMD.adjoint=function(t,a){var e,n,r,o,i,s,l,u,h,c,M,f,m,e=SIMD.Float32x4.load(a,0),n=SIMD.Float32x4.load(a,4),r=SIMD.Float32x4.load(a,8),o=SIMD.Float32x4.load(a,12);return h=SIMD.Float32x4.shuffle(e,n,0,1,4,5),s=SIMD.Float32x4.shuffle(r,o,0,1,4,5),i=SIMD.Float32x4.shuffle(h,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,h,1,3,5,7),h=SIMD.Float32x4.shuffle(e,n,2,3,6,7),u=SIMD.Float32x4.shuffle(r,o,2,3,6,7),l=SIMD.Float32x4.shuffle(h,u,0,2,4,6),u=SIMD.Float32x4.shuffle(u,h,1,3,5,7),h=SIMD.Float32x4.mul(l,u),h=SIMD.Float32x4.swizzle(h,1,0,3,2),c=SIMD.Float32x4.mul(s,h),M=SIMD.Float32x4.mul(i,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,h),c),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,h),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),h=SIMD.Float32x4.mul(s,l),h=SIMD.Float32x4.swizzle(h,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),c),m=SIMD.Float32x4.mul(i,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(u,h)),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,h),m),m=SIMD.Float32x4.swizzle(m,2,3,0,1),h=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),u),h=SIMD.Float32x4.swizzle(h,1,0,3,2),l=SIMD.Float32x4.swizzle(l,2,3,0,1),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),c),f=SIMD.Float32x4.mul(i,h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(l,h)),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,h),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),h=SIMD.Float32x4.mul(i,s),h=SIMD.Float32x4.swizzle(h,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),f),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,h),m),h=SIMD.Float32x4.swizzle(h,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,h),f),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(l,h)),h=SIMD.Float32x4.mul(i,u),h=SIMD.Float32x4.swizzle(h,1,0,3,2),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(l,h)),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,h),f),h=SIMD.Float32x4.swizzle(h,2,3,0,1),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,h),M),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,h)),h=SIMD.Float32x4.mul(i,l),h=SIMD.Float32x4.swizzle(h,1,0,3,2),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,h),M),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(s,h)),h=SIMD.Float32x4.swizzle(h,2,3,0,1),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(u,h)),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,h),m),SIMD.Float32x4.store(t,0,c),SIMD.Float32x4.store(t,4,M),SIMD.Float32x4.store(t,8,f),SIMD.Float32x4.store(t,12,m),t},r.adjoint=n.USE_SIMD?r.SIMD.adjoint:r.scalar.adjoint,r.determinant=function(t){var a=t[0],e=t[1],n=t[2],r=t[3],o=t[4],i=t[5],s=t[6],l=t[7],u=t[8],h=t[9],c=t[10],M=t[11],f=t[12],m=t[13],d=t[14],x=t[15],S=a*i-e*o,v=a*s-n*o,I=a*l-r*o,D=e*s-n*i,F=e*l-r*i,g=n*l-r*s,b=u*m-h*f,p=u*d-c*f,w=u*x-M*f,E=h*d-c*m,y=h*x-M*m,R=c*x-M*d;return S*R-v*y+I*E+D*w-F*p+g*b},r.SIMD.multiply=function(t,a,e){var n=SIMD.Float32x4.load(a,0),r=SIMD.Float32x4.load(a,4),o=SIMD.Float32x4.load(a,8),i=SIMD.Float32x4.load(a,12),s=SIMD.Float32x4.load(e,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),i))));SIMD.Float32x4.store(t,0,l);var u=SIMD.Float32x4.load(e,4),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(u,3,3,3,3),i))));SIMD.Float32x4.store(t,4,h);var c=SIMD.Float32x4.load(e,8),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),i))));SIMD.Float32x4.store(t,8,M);var f=SIMD.Float32x4.load(e,12),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),i))));return SIMD.Float32x4.store(t,12,m),t},r.scalar.multiply=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=a[4],l=a[5],u=a[6],h=a[7],c=a[8],M=a[9],f=a[10],m=a[11],d=a[12],x=a[13],S=a[14],v=a[15],I=e[0],D=e[1],F=e[2],g=e[3];return t[0]=I*n+D*s+F*c+g*d,t[1]=I*r+D*l+F*M+g*x,t[2]=I*o+D*u+F*f+g*S,t[3]=I*i+D*h+F*m+g*v,I=e[4],D=e[5],F=e[6],g=e[7],t[4]=I*n+D*s+F*c+g*d,t[5]=I*r+D*l+F*M+g*x,t[6]=I*o+D*u+F*f+g*S,t[7]=I*i+D*h+F*m+g*v,I=e[8],D=e[9],F=e[10],g=e[11],t[8]=I*n+D*s+F*c+g*d,t[9]=I*r+D*l+F*M+g*x,t[10]=I*o+D*u+F*f+g*S,t[11]=I*i+D*h+F*m+g*v,I=e[12],D=e[13],F=e[14],g=e[15],t[12]=I*n+D*s+F*c+g*d,t[13]=I*r+D*l+F*M+g*x,t[14]=I*o+D*u+F*f+g*S,t[15]=I*i+D*h+F*m+g*v,t},r.multiply=n.USE_SIMD?r.SIMD.multiply:r.scalar.multiply,r.mul=r.multiply,r.scalar.translate=function(t,a,e){var n,r,o,i,s,l,u,h,c,M,f,m,d=e[0],x=e[1],S=e[2];return a===t?(t[12]=a[0]*d+a[4]*x+a[8]*S+a[12],t[13]=a[1]*d+a[5]*x+a[9]*S+a[13],t[14]=a[2]*d+a[6]*x+a[10]*S+a[14],t[15]=a[3]*d+a[7]*x+a[11]*S+a[15]):(n=a[0],r=a[1],o=a[2],i=a[3],s=a[4],l=a[5],u=a[6],h=a[7],c=a[8],M=a[9],f=a[10],m=a[11],t[0]=n,t[1]=r,t[2]=o,t[3]=i,t[4]=s,t[5]=l,t[6]=u,t[7]=h,t[8]=c,t[9]=M,t[10]=f,t[11]=m,t[12]=n*d+s*x+c*S+a[12],t[13]=r*d+l*x+M*S+a[13],t[14]=o*d+u*x+f*S+a[14],t[15]=i*d+h*x+m*S+a[15]),t},r.SIMD.translate=function(t,a,e){var n=SIMD.Float32x4.load(a,0),r=SIMD.Float32x4.load(a,4),o=SIMD.Float32x4.load(a,8),i=SIMD.Float32x4.load(a,12),s=SIMD.Float32x4(e[0],e[1],e[2],0);a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11]),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(s,0,0,0,0)),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2));var l=SIMD.Float32x4.add(n,SIMD.Float32x4.add(r,SIMD.Float32x4.add(o,i)));return SIMD.Float32x4.store(t,12,l),t},r.translate=n.USE_SIMD?r.SIMD.translate:r.scalar.translate,r.scalar.scale=function(t,a,e){var n=e[0],r=e[1],o=e[2];return t[0]=a[0]*n,t[1]=a[1]*n,t[2]=a[2]*n,t[3]=a[3]*n,t[4]=a[4]*r,t[5]=a[5]*r,t[6]=a[6]*r,t[7]=a[7]*r,t[8]=a[8]*o,t[9]=a[9]*o,t[10]=a[10]*o,t[11]=a[11]*o,t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},r.SIMD.scale=function(t,a,e){var n,r,o,i=SIMD.Float32x4(e[0],e[1],e[2],0);return n=SIMD.Float32x4.load(a,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(i,0,0,0,0))),r=SIMD.Float32x4.load(a,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(i,1,1,1,1))),o=SIMD.Float32x4.load(a,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,2,2,2,2))),t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},r.scale=n.USE_SIMD?r.SIMD.scale:r.scalar.scale,r.rotate=function(t,a,e,r){var o,i,s,l,u,h,c,M,f,m,d,x,S,v,I,D,F,g,b,p,w,E,y,R,P=r[0],z=r[1],A=r[2],T=Math.sqrt(P*P+z*z+A*A);return Math.abs(T)<n.EPSILON?null:(T=1/T,P*=T,z*=T,A*=T,o=Math.sin(e),i=Math.cos(e),s=1-i,l=a[0],u=a[1],h=a[2],c=a[3],M=a[4],f=a[5],m=a[6],d=a[7],x=a[8],S=a[9],v=a[10],I=a[11],D=P*P*s+i,F=z*P*s+A*o,g=A*P*s-z*o,b=P*z*s-A*o,p=z*z*s+i,w=A*z*s+P*o,E=P*A*s+z*o,y=z*A*s-P*o,R=A*A*s+i,t[0]=l*D+M*F+x*g,t[1]=u*D+f*F+S*g,t[2]=h*D+m*F+v*g,t[3]=c*D+d*F+I*g,t[4]=l*b+M*p+x*w,t[5]=u*b+f*p+S*w,t[6]=h*b+m*p+v*w,t[7]=c*b+d*p+I*w,t[8]=l*E+M*y+x*R,t[9]=u*E+f*y+S*R,t[10]=h*E+m*y+v*R,t[11]=c*E+d*y+I*R,a!==t&&(t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t)},r.scalar.rotateX=function(t,a,e){var n=Math.sin(e),r=Math.cos(e),o=a[4],i=a[5],s=a[6],l=a[7],u=a[8],h=a[9],c=a[10],M=a[11];return a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[4]=o*r+u*n,t[5]=i*r+h*n,t[6]=s*r+c*n,t[7]=l*r+M*n,t[8]=u*r-o*n,t[9]=h*r-i*n,t[10]=c*r-s*n,t[11]=M*r-l*n,t},r.SIMD.rotateX=function(t,a,e){var n=SIMD.Float32x4.splat(Math.sin(e)),r=SIMD.Float32x4.splat(Math.cos(e));a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]);var o=SIMD.Float32x4.load(a,4),i=SIMD.Float32x4.load(a,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,n))),t},r.rotateX=n.USE_SIMD?r.SIMD.rotateX:r.scalar.rotateX,r.scalar.rotateY=function(t,a,e){var n=Math.sin(e),r=Math.cos(e),o=a[0],i=a[1],s=a[2],l=a[3],u=a[8],h=a[9],c=a[10],M=a[11];return a!==t&&(t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=o*r-u*n,t[1]=i*r-h*n,t[2]=s*r-c*n,t[3]=l*r-M*n,t[8]=o*n+u*r,t[9]=i*n+h*r,t[10]=s*n+c*r,t[11]=l*n+M*r,t},r.SIMD.rotateY=function(t,a,e){var n=SIMD.Float32x4.splat(Math.sin(e)),r=SIMD.Float32x4.splat(Math.cos(e));a!==t&&(t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]);var o=SIMD.Float32x4.load(a,0),i=SIMD.Float32x4.load(a,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(i,r))),t},r.rotateY=n.USE_SIMD?r.SIMD.rotateY:r.scalar.rotateY,r.scalar.rotateZ=function(t,a,e){var n=Math.sin(e),r=Math.cos(e),o=a[0],i=a[1],s=a[2],l=a[3],u=a[4],h=a[5],c=a[6],M=a[7];return a!==t&&(t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=o*r+u*n,t[1]=i*r+h*n,t[2]=s*r+c*n,t[3]=l*r+M*n,t[4]=u*r-o*n,t[5]=h*r-i*n,t[6]=c*r-s*n,t[7]=M*r-l*n,t},r.SIMD.rotateZ=function(t,a,e){var n=SIMD.Float32x4.splat(Math.sin(e)),r=SIMD.Float32x4.splat(Math.cos(e));a!==t&&(t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]);var o=SIMD.Float32x4.load(a,0),i=SIMD.Float32x4.load(a,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(i,n))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,r),SIMD.Float32x4.mul(o,n))),t},r.rotateZ=n.USE_SIMD?r.SIMD.rotateZ:r.scalar.rotateZ,r.fromTranslation=function(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},r.fromScaling=function(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=a[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,a,e){var r,o,i,s=e[0],l=e[1],u=e[2],h=Math.sqrt(s*s+l*l+u*u);return Math.abs(h)<n.EPSILON?null:(h=1/h,s*=h,l*=h,u*=h,r=Math.sin(a),o=Math.cos(a),i=1-o,t[0]=s*s*i+o,t[1]=l*s*i+u*r,t[2]=u*s*i-l*r,t[3]=0,t[4]=s*l*i-u*r,t[5]=l*l*i+o,t[6]=u*l*i+s*r,t[7]=0,t[8]=s*u*i+l*r,t[9]=l*u*i-s*r,t[10]=u*u*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},r.fromXRotation=function(t,a){var e=Math.sin(a),n=Math.cos(a);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=e,t[7]=0,t[8]=0,t[9]=-e,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,a){var e=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=0,t[2]=-e,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=e,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,a){var e=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=e,t[2]=0,t[3]=0,t[4]=-e,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=n+n,l=r+r,u=o+o,h=n*s,c=n*l,M=n*u,f=r*l,m=r*u,d=o*u,x=i*s,S=i*l,v=i*u;return t[0]=1-(f+d),t[1]=c+v,t[2]=M-S,t[3]=0,t[4]=c-v,t[5]=1-(h+d),t[6]=m+x,t[7]=0,t[8]=M+S,t[9]=m-x,t[10]=1-(h+f),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.getTranslation=function(t,a){return t[0]=a[12],t[1]=a[13],t[2]=a[14],t},r.getRotation=function(t,a){var e=a[0]+a[5]+a[10],n=0;return e>0?(n=2*Math.sqrt(e+1),t[3]=.25*n,t[0]=(a[6]-a[9])/n,t[1]=(a[8]-a[2])/n,t[2]=(a[1]-a[4])/n):a[0]>a[5]&a[0]>a[10]?(n=2*Math.sqrt(1+a[0]-a[5]-a[10]),t[3]=(a[6]-a[9])/n,t[0]=.25*n,t[1]=(a[1]+a[4])/n,t[2]=(a[8]+a[2])/n):a[5]>a[10]?(n=2*Math.sqrt(1+a[5]-a[0]-a[10]),t[3]=(a[8]-a[2])/n,t[0]=(a[1]+a[4])/n,t[1]=.25*n,
t[2]=(a[6]+a[9])/n):(n=2*Math.sqrt(1+a[10]-a[0]-a[5]),t[3]=(a[1]-a[4])/n,t[0]=(a[8]+a[2])/n,t[1]=(a[6]+a[9])/n,t[2]=.25*n),t},r.fromRotationTranslationScale=function(t,a,e,n){var r=a[0],o=a[1],i=a[2],s=a[3],l=r+r,u=o+o,h=i+i,c=r*l,M=r*u,f=r*h,m=o*u,d=o*h,x=i*h,S=s*l,v=s*u,I=s*h,D=n[0],F=n[1],g=n[2];return t[0]=(1-(m+x))*D,t[1]=(M+I)*D,t[2]=(f-v)*D,t[3]=0,t[4]=(M-I)*F,t[5]=(1-(c+x))*F,t[6]=(d+S)*F,t[7]=0,t[8]=(f+v)*g,t[9]=(d-S)*g,t[10]=(1-(c+m))*g,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,a,e,n,r){var o=a[0],i=a[1],s=a[2],l=a[3],u=o+o,h=i+i,c=s+s,M=o*u,f=o*h,m=o*c,d=i*h,x=i*c,S=s*c,v=l*u,I=l*h,D=l*c,F=n[0],g=n[1],b=n[2],p=r[0],w=r[1],E=r[2];return t[0]=(1-(d+S))*F,t[1]=(f+D)*F,t[2]=(m-I)*F,t[3]=0,t[4]=(f-D)*g,t[5]=(1-(M+S))*g,t[6]=(x+v)*g,t[7]=0,t[8]=(m+I)*b,t[9]=(x-v)*b,t[10]=(1-(M+d))*b,t[11]=0,t[12]=e[0]+p-(t[0]*p+t[4]*w+t[8]*E),t[13]=e[1]+w-(t[1]*p+t[5]*w+t[9]*E),t[14]=e[2]+E-(t[2]*p+t[6]*w+t[10]*E),t[15]=1,t},r.fromQuat=function(t,a){var e=a[0],n=a[1],r=a[2],o=a[3],i=e+e,s=n+n,l=r+r,u=e*i,h=n*i,c=n*s,M=r*i,f=r*s,m=r*l,d=o*i,x=o*s,S=o*l;return t[0]=1-c-m,t[1]=h+S,t[2]=M-x,t[3]=0,t[4]=h-S,t[5]=1-u-m,t[6]=f+d,t[7]=0,t[8]=M+x,t[9]=f-d,t[10]=1-u-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,a,e,n,r,o,i){var s=1/(e-a),l=1/(r-n),u=1/(o-i);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(e+a)*s,t[9]=(r+n)*l,t[10]=(i+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*u,t[15]=0,t},r.perspective=function(t,a,e,n,r){var o=1/Math.tan(a/2),i=1/(n-r);return t[0]=o/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+n)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*n*i,t[15]=0,t},r.perspectiveFromFieldOfView=function(t,a,e,n){var r=Math.tan(a.upDegrees*Math.PI/180),o=Math.tan(a.downDegrees*Math.PI/180),i=Math.tan(a.leftDegrees*Math.PI/180),s=Math.tan(a.rightDegrees*Math.PI/180),l=2/(i+s),u=2/(r+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((i-s)*l*.5),t[9]=(r-o)*u*.5,t[10]=n/(e-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*e/(e-n),t[15]=0,t},r.ortho=function(t,a,e,n,r,o,i){var s=1/(a-e),l=1/(n-r),u=1/(o-i);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(a+e)*s,t[13]=(r+n)*l,t[14]=(i+o)*u,t[15]=1,t},r.lookAt=function(t,a,e,o){var i,s,l,u,h,c,M,f,m,d,x=a[0],S=a[1],v=a[2],I=o[0],D=o[1],F=o[2],g=e[0],b=e[1],p=e[2];return Math.abs(x-g)<n.EPSILON&&Math.abs(S-b)<n.EPSILON&&Math.abs(v-p)<n.EPSILON?r.identity(t):(M=x-g,f=S-b,m=v-p,d=1/Math.sqrt(M*M+f*f+m*m),M*=d,f*=d,m*=d,i=D*m-F*f,s=F*M-I*m,l=I*f-D*M,d=Math.sqrt(i*i+s*s+l*l),d?(d=1/d,i*=d,s*=d,l*=d):(i=0,s=0,l=0),u=f*l-m*s,h=m*i-M*l,c=M*s-f*i,d=Math.sqrt(u*u+h*h+c*c),d?(d=1/d,u*=d,h*=d,c*=d):(u=0,h=0,c=0),t[0]=i,t[1]=u,t[2]=M,t[3]=0,t[4]=s,t[5]=h,t[6]=f,t[7]=0,t[8]=l,t[9]=c,t[10]=m,t[11]=0,t[12]=-(i*x+s*S+l*v),t[13]=-(u*x+h*S+c*v),t[14]=-(M*x+f*S+m*v),t[15]=1,t)},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},r.add=function(t,a,e){return t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t[3]=a[3]+e[3],t[4]=a[4]+e[4],t[5]=a[5]+e[5],t[6]=a[6]+e[6],t[7]=a[7]+e[7],t[8]=a[8]+e[8],t[9]=a[9]+e[9],t[10]=a[10]+e[10],t[11]=a[11]+e[11],t[12]=a[12]+e[12],t[13]=a[13]+e[13],t[14]=a[14]+e[14],t[15]=a[15]+e[15],t},r.subtract=function(t,a,e){return t[0]=a[0]-e[0],t[1]=a[1]-e[1],t[2]=a[2]-e[2],t[3]=a[3]-e[3],t[4]=a[4]-e[4],t[5]=a[5]-e[5],t[6]=a[6]-e[6],t[7]=a[7]-e[7],t[8]=a[8]-e[8],t[9]=a[9]-e[9],t[10]=a[10]-e[10],t[11]=a[11]-e[11],t[12]=a[12]-e[12],t[13]=a[13]-e[13],t[14]=a[14]-e[14],t[15]=a[15]-e[15],t},r.sub=r.subtract,r.multiplyScalar=function(t,a,e){return t[0]=a[0]*e,t[1]=a[1]*e,t[2]=a[2]*e,t[3]=a[3]*e,t[4]=a[4]*e,t[5]=a[5]*e,t[6]=a[6]*e,t[7]=a[7]*e,t[8]=a[8]*e,t[9]=a[9]*e,t[10]=a[10]*e,t[11]=a[11]*e,t[12]=a[12]*e,t[13]=a[13]*e,t[14]=a[14]*e,t[15]=a[15]*e,t},r.multiplyScalarAndAdd=function(t,a,e,n){return t[0]=a[0]+e[0]*n,t[1]=a[1]+e[1]*n,t[2]=a[2]+e[2]*n,t[3]=a[3]+e[3]*n,t[4]=a[4]+e[4]*n,t[5]=a[5]+e[5]*n,t[6]=a[6]+e[6]*n,t[7]=a[7]+e[7]*n,t[8]=a[8]+e[8]*n,t[9]=a[9]+e[9]*n,t[10]=a[10]+e[10]*n,t[11]=a[11]+e[11]*n,t[12]=a[12]+e[12]*n,t[13]=a[13]+e[13]*n,t[14]=a[14]+e[14]*n,t[15]=a[15]+e[15]*n,t},r.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]&&t[9]===a[9]&&t[10]===a[10]&&t[11]===a[11]&&t[12]===a[12]&&t[13]===a[13]&&t[14]===a[14]&&t[15]===a[15]},r.equals=function(t,a){var e=t[0],r=t[1],o=t[2],i=t[3],s=t[4],l=t[5],u=t[6],h=t[7],c=t[8],M=t[9],f=t[10],m=t[11],d=t[12],x=t[13],S=t[14],v=t[15],I=a[0],D=a[1],F=a[2],g=a[3],b=a[4],p=a[5],w=a[6],E=a[7],y=a[8],R=a[9],P=a[10],z=a[11],A=a[12],T=a[13],L=a[14],_=a[15];return Math.abs(e-I)<=n.EPSILON*Math.max(1,Math.abs(e),Math.abs(I))&&Math.abs(r-D)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(D))&&Math.abs(o-F)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(F))&&Math.abs(i-g)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(s-b)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(l-p)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(u-w)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-E)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(c-y)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(M-R)<=n.EPSILON*Math.max(1,Math.abs(M),Math.abs(R))&&Math.abs(f-P)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(m-z)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(z))&&Math.abs(d-A)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(x-T)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(T))&&Math.abs(S-L)<=n.EPSILON*Math.max(1,Math.abs(S),Math.abs(L))&&Math.abs(v-_)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(_))},t.exports=r},function(t,a,e){var n=e(1),r=e(4),o=e(7),i=e(8),s={};s.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=o.create(),a=o.fromValues(1,0,0),e=o.fromValues(0,1,0);return function(n,r,i){var l=o.dot(r,i);return-.999999>l?(o.cross(t,a,r),o.length(t)<1e-6&&o.cross(t,e,r),o.normalize(t,t),s.setAxisAngle(n,t,Math.PI),n):l>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,r,i),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+l,s.normalize(n,n))}}(),s.setAxes=function(){var t=r.create();return function(a,e,n,r){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],s.normalize(a,s.fromMat3(a,t))}}(),s.clone=i.clone,s.fromValues=i.fromValues,s.copy=i.copy,s.set=i.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,a,e){e=.5*e;var n=Math.sin(e);return t[0]=n*a[0],t[1]=n*a[1],t[2]=n*a[2],t[3]=Math.cos(e),t},s.getAxisAngle=function(t,a){var e=2*Math.acos(a[3]),n=Math.sin(e/2);return 0!=n?(t[0]=a[0]/n,t[1]=a[1]/n,t[2]=a[2]/n):(t[0]=1,t[1]=0,t[2]=0),e},s.add=i.add,s.multiply=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3],s=e[0],l=e[1],u=e[2],h=e[3];return t[0]=n*h+i*s+r*u-o*l,t[1]=r*h+i*l+o*s-n*u,t[2]=o*h+i*u+n*l-r*s,t[3]=i*h-n*s-r*l-o*u,t},s.mul=s.multiply,s.scale=i.scale,s.rotateX=function(t,a,e){e*=.5;var n=a[0],r=a[1],o=a[2],i=a[3],s=Math.sin(e),l=Math.cos(e);return t[0]=n*l+i*s,t[1]=r*l+o*s,t[2]=o*l-r*s,t[3]=i*l-n*s,t},s.rotateY=function(t,a,e){e*=.5;var n=a[0],r=a[1],o=a[2],i=a[3],s=Math.sin(e),l=Math.cos(e);return t[0]=n*l-o*s,t[1]=r*l+i*s,t[2]=o*l+n*s,t[3]=i*l-r*s,t},s.rotateZ=function(t,a,e){e*=.5;var n=a[0],r=a[1],o=a[2],i=a[3],s=Math.sin(e),l=Math.cos(e);return t[0]=n*l+r*s,t[1]=r*l-n*s,t[2]=o*l+i*s,t[3]=i*l-o*s,t},s.calculateW=function(t,a){var e=a[0],n=a[1],r=a[2];return t[0]=e,t[1]=n,t[2]=r,t[3]=Math.sqrt(Math.abs(1-e*e-n*n-r*r)),t},s.dot=i.dot,s.lerp=i.lerp,s.slerp=function(t,a,e,n){var r,o,i,s,l,u=a[0],h=a[1],c=a[2],M=a[3],f=e[0],m=e[1],d=e[2],x=e[3];return o=u*f+h*m+c*d+M*x,0>o&&(o=-o,f=-f,m=-m,d=-d,x=-x),1-o>1e-6?(r=Math.acos(o),i=Math.sin(r),s=Math.sin((1-n)*r)/i,l=Math.sin(n*r)/i):(s=1-n,l=n),t[0]=s*u+l*f,t[1]=s*h+l*m,t[2]=s*c+l*d,t[3]=s*M+l*x,t},s.sqlerp=function(){var t=s.create(),a=s.create();return function(e,n,r,o,i,l){return s.slerp(t,n,i,l),s.slerp(a,r,o,l),s.slerp(e,t,a,2*l*(1-l)),e}}(),s.invert=function(t,a){var e=a[0],n=a[1],r=a[2],o=a[3],i=e*e+n*n+r*r+o*o,s=i?1/i:0;return t[0]=-e*s,t[1]=-n*s,t[2]=-r*s,t[3]=o*s,t},s.conjugate=function(t,a){return t[0]=-a[0],t[1]=-a[1],t[2]=-a[2],t[3]=a[3],t},s.length=i.length,s.len=s.length,s.squaredLength=i.squaredLength,s.sqrLen=s.squaredLength,s.normalize=i.normalize,s.fromMat3=function(t,a){var e,n=a[0]+a[4]+a[8];if(n>0)e=Math.sqrt(n+1),t[3]=.5*e,e=.5/e,t[0]=(a[5]-a[7])*e,t[1]=(a[6]-a[2])*e,t[2]=(a[1]-a[3])*e;else{var r=0;a[4]>a[0]&&(r=1),a[8]>a[3*r+r]&&(r=2);var o=(r+1)%3,i=(r+2)%3;e=Math.sqrt(a[3*r+r]-a[3*o+o]-a[3*i+i]+1),t[r]=.5*e,e=.5/e,t[3]=(a[3*o+i]-a[3*i+o])*e,t[o]=(a[3*o+r]+a[3*r+o])*e,t[i]=(a[3*i+r]+a[3*r+i])*e}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},s.exactEquals=i.exactEquals,s.equals=i.equals,t.exports=s},function(t,a,e){var n=e(1),r={};r.create=function(){var t=new n.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},r.clone=function(t){var a=new n.ARRAY_TYPE(3);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a},r.fromValues=function(t,a,e){var r=new n.ARRAY_TYPE(3);return r[0]=t,r[1]=a,r[2]=e,r},r.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t},r.set=function(t,a,e,n){return t[0]=a,t[1]=e,t[2]=n,t},r.add=function(t,a,e){return t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t},r.subtract=function(t,a,e){return t[0]=a[0]-e[0],t[1]=a[1]-e[1],t[2]=a[2]-e[2],t},r.sub=r.subtract,r.multiply=function(t,a,e){return t[0]=a[0]*e[0],t[1]=a[1]*e[1],t[2]=a[2]*e[2],t},r.mul=r.multiply,r.divide=function(t,a,e){return t[0]=a[0]/e[0],t[1]=a[1]/e[1],t[2]=a[2]/e[2],t},r.div=r.divide,r.ceil=function(t,a){return t[0]=Math.ceil(a[0]),t[1]=Math.ceil(a[1]),t[2]=Math.ceil(a[2]),t},r.floor=function(t,a){return t[0]=Math.floor(a[0]),t[1]=Math.floor(a[1]),t[2]=Math.floor(a[2]),t},r.min=function(t,a,e){return t[0]=Math.min(a[0],e[0]),t[1]=Math.min(a[1],e[1]),t[2]=Math.min(a[2],e[2]),t},r.max=function(t,a,e){return t[0]=Math.max(a[0],e[0]),t[1]=Math.max(a[1],e[1]),t[2]=Math.max(a[2],e[2]),t},r.round=function(t,a){return t[0]=Math.round(a[0]),t[1]=Math.round(a[1]),t[2]=Math.round(a[2]),t},r.scale=function(t,a,e){return t[0]=a[0]*e,t[1]=a[1]*e,t[2]=a[2]*e,t},r.scaleAndAdd=function(t,a,e,n){return t[0]=a[0]+e[0]*n,t[1]=a[1]+e[1]*n,t[2]=a[2]+e[2]*n,t},r.distance=function(t,a){var e=a[0]-t[0],n=a[1]-t[1],r=a[2]-t[2];return Math.sqrt(e*e+n*n+r*r)},r.dist=r.distance,r.squaredDistance=function(t,a){var e=a[0]-t[0],n=a[1]-t[1],r=a[2]-t[2];return e*e+n*n+r*r},r.sqrDist=r.squaredDistance,r.length=function(t){var a=t[0],e=t[1],n=t[2];return Math.sqrt(a*a+e*e+n*n)},r.len=r.length,r.squaredLength=function(t){var a=t[0],e=t[1],n=t[2];return a*a+e*e+n*n},r.sqrLen=r.squaredLength,r.negate=function(t,a){return t[0]=-a[0],t[1]=-a[1],t[2]=-a[2],t},r.inverse=function(t,a){return t[0]=1/a[0],t[1]=1/a[1],t[2]=1/a[2],t},r.normalize=function(t,a){var e=a[0],n=a[1],r=a[2],o=e*e+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=a[0]*o,t[1]=a[1]*o,t[2]=a[2]*o),t},r.dot=function(t,a){return t[0]*a[0]+t[1]*a[1]+t[2]*a[2]},r.cross=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=e[0],s=e[1],l=e[2];return t[0]=r*l-o*s,t[1]=o*i-n*l,t[2]=n*s-r*i,t},r.lerp=function(t,a,e,n){var r=a[0],o=a[1],i=a[2];return t[0]=r+n*(e[0]-r),t[1]=o+n*(e[1]-o),t[2]=i+n*(e[2]-i),t},r.hermite=function(t,a,e,n,r,o){var i=o*o,s=i*(2*o-3)+1,l=i*(o-2)+o,u=i*(o-1),h=i*(3-2*o);return t[0]=a[0]*s+e[0]*l+n[0]*u+r[0]*h,t[1]=a[1]*s+e[1]*l+n[1]*u+r[1]*h,t[2]=a[2]*s+e[2]*l+n[2]*u+r[2]*h,t},r.bezier=function(t,a,e,n,r,o){var i=1-o,s=i*i,l=o*o,u=s*i,h=3*o*s,c=3*l*i,M=l*o;return t[0]=a[0]*u+e[0]*h+n[0]*c+r[0]*M,t[1]=a[1]*u+e[1]*h+n[1]*c+r[1]*M,t[2]=a[2]*u+e[2]*h+n[2]*c+r[2]*M,t},r.random=function(t,a){a=a||1;var e=2*n.RANDOM()*Math.PI,r=2*n.RANDOM()-1,o=Math.sqrt(1-r*r)*a;return t[0]=Math.cos(e)*o,t[1]=Math.sin(e)*o,t[2]=r*a,t},r.transformMat4=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=e[3]*n+e[7]*r+e[11]*o+e[15];return i=i||1,t[0]=(e[0]*n+e[4]*r+e[8]*o+e[12])/i,t[1]=(e[1]*n+e[5]*r+e[9]*o+e[13])/i,t[2]=(e[2]*n+e[6]*r+e[10]*o+e[14])/i,t},r.transformMat3=function(t,a,e){var n=a[0],r=a[1],o=a[2];return t[0]=n*e[0]+r*e[3]+o*e[6],t[1]=n*e[1]+r*e[4]+o*e[7],t[2]=n*e[2]+r*e[5]+o*e[8],t},r.transformQuat=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=e[0],s=e[1],l=e[2],u=e[3],h=u*n+s*o-l*r,c=u*r+l*n-i*o,M=u*o+i*r-s*n,f=-i*n-s*r-l*o;return t[0]=h*u+f*-i+c*-l-M*-s,t[1]=c*u+f*-s+M*-i-h*-l,t[2]=M*u+f*-l+h*-s-c*-i,t},r.rotateX=function(t,a,e,n){var r=[],o=[];return r[0]=a[0]-e[0],r[1]=a[1]-e[1],r[2]=a[2]-e[2],o[0]=r[0],o[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),o[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t},r.rotateY=function(t,a,e,n){var r=[],o=[];return r[0]=a[0]-e[0],r[1]=a[1]-e[1],r[2]=a[2]-e[2],o[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),o[1]=r[1],o[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t},r.rotateZ=function(t,a,e,n){var r=[],o=[];return r[0]=a[0]-e[0],r[1]=a[1]-e[1],r[2]=a[2]-e[2],o[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),o[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),o[2]=r[2],t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t},r.forEach=function(){var t=r.create();return function(a,e,n,r,o,i){var s,l;for(e||(e=3),n||(n=0),l=r?Math.min(r*e+n,a.length):a.length,s=n;l>s;s+=e)t[0]=a[s],t[1]=a[s+1],t[2]=a[s+2],o(t,t,i),a[s]=t[0],a[s+1]=t[1],a[s+2]=t[2];return a}}(),r.angle=function(t,a){var e=r.fromValues(t[0],t[1],t[2]),n=r.fromValues(a[0],a[1],a[2]);r.normalize(e,e),r.normalize(n,n);var o=r.dot(e,n);return o>1?0:Math.acos(o)},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},r.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]},r.equals=function(t,a){var e=t[0],r=t[1],o=t[2],i=a[0],s=a[1],l=a[2];return Math.abs(e-i)<=n.EPSILON*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(r-s)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(o-l)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},t.exports=r},function(t,a,e){var n=e(1),r={};r.create=function(){var t=new n.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.clone=function(t){var a=new n.ARRAY_TYPE(4);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a},r.fromValues=function(t,a,e,r){var o=new n.ARRAY_TYPE(4);return o[0]=t,o[1]=a,o[2]=e,o[3]=r,o},r.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t},r.set=function(t,a,e,n,r){return t[0]=a,t[1]=e,t[2]=n,t[3]=r,t},r.add=function(t,a,e){return t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t[3]=a[3]+e[3],t},r.subtract=function(t,a,e){return t[0]=a[0]-e[0],t[1]=a[1]-e[1],t[2]=a[2]-e[2],t[3]=a[3]-e[3],t},r.sub=r.subtract,r.multiply=function(t,a,e){return t[0]=a[0]*e[0],t[1]=a[1]*e[1],t[2]=a[2]*e[2],t[3]=a[3]*e[3],t},r.mul=r.multiply,r.divide=function(t,a,e){return t[0]=a[0]/e[0],t[1]=a[1]/e[1],t[2]=a[2]/e[2],t[3]=a[3]/e[3],t},r.div=r.divide,r.ceil=function(t,a){return t[0]=Math.ceil(a[0]),t[1]=Math.ceil(a[1]),t[2]=Math.ceil(a[2]),t[3]=Math.ceil(a[3]),t},r.floor=function(t,a){return t[0]=Math.floor(a[0]),t[1]=Math.floor(a[1]),t[2]=Math.floor(a[2]),t[3]=Math.floor(a[3]),t},r.min=function(t,a,e){return t[0]=Math.min(a[0],e[0]),t[1]=Math.min(a[1],e[1]),t[2]=Math.min(a[2],e[2]),t[3]=Math.min(a[3],e[3]),t},r.max=function(t,a,e){return t[0]=Math.max(a[0],e[0]),t[1]=Math.max(a[1],e[1]),t[2]=Math.max(a[2],e[2]),t[3]=Math.max(a[3],e[3]),t},r.round=function(t,a){return t[0]=Math.round(a[0]),t[1]=Math.round(a[1]),t[2]=Math.round(a[2]),t[3]=Math.round(a[3]),t},r.scale=function(t,a,e){return t[0]=a[0]*e,t[1]=a[1]*e,t[2]=a[2]*e,t[3]=a[3]*e,t},r.scaleAndAdd=function(t,a,e,n){return t[0]=a[0]+e[0]*n,t[1]=a[1]+e[1]*n,t[2]=a[2]+e[2]*n,t[3]=a[3]+e[3]*n,t},r.distance=function(t,a){var e=a[0]-t[0],n=a[1]-t[1],r=a[2]-t[2],o=a[3]-t[3];return Math.sqrt(e*e+n*n+r*r+o*o)},r.dist=r.distance,r.squaredDistance=function(t,a){var e=a[0]-t[0],n=a[1]-t[1],r=a[2]-t[2],o=a[3]-t[3];return e*e+n*n+r*r+o*o},r.sqrDist=r.squaredDistance,r.length=function(t){var a=t[0],e=t[1],n=t[2],r=t[3];return Math.sqrt(a*a+e*e+n*n+r*r)},r.len=r.length,r.squaredLength=function(t){var a=t[0],e=t[1],n=t[2],r=t[3];return a*a+e*e+n*n+r*r},r.sqrLen=r.squaredLength,r.negate=function(t,a){return t[0]=-a[0],t[1]=-a[1],t[2]=-a[2],t[3]=-a[3],t},r.inverse=function(t,a){return t[0]=1/a[0],t[1]=1/a[1],t[2]=1/a[2],t[3]=1/a[3],t},r.normalize=function(t,a){var e=a[0],n=a[1],r=a[2],o=a[3],i=e*e+n*n+r*r+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=e*i,t[1]=n*i,t[2]=r*i,t[3]=o*i),t},r.dot=function(t,a){return t[0]*a[0]+t[1]*a[1]+t[2]*a[2]+t[3]*a[3]},r.lerp=function(t,a,e,n){var r=a[0],o=a[1],i=a[2],s=a[3];return t[0]=r+n*(e[0]-r),t[1]=o+n*(e[1]-o),t[2]=i+n*(e[2]-i),t[3]=s+n*(e[3]-s),t},r.random=function(t,a){return a=a||1,t[0]=n.RANDOM(),t[1]=n.RANDOM(),t[2]=n.RANDOM(),t[3]=n.RANDOM(),r.normalize(t,t),r.scale(t,t,a),t},r.transformMat4=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=a[3];return t[0]=e[0]*n+e[4]*r+e[8]*o+e[12]*i,t[1]=e[1]*n+e[5]*r+e[9]*o+e[13]*i,t[2]=e[2]*n+e[6]*r+e[10]*o+e[14]*i,t[3]=e[3]*n+e[7]*r+e[11]*o+e[15]*i,t},r.transformQuat=function(t,a,e){var n=a[0],r=a[1],o=a[2],i=e[0],s=e[1],l=e[2],u=e[3],h=u*n+s*o-l*r,c=u*r+l*n-i*o,M=u*o+i*r-s*n,f=-i*n-s*r-l*o;return t[0]=h*u+f*-i+c*-l-M*-s,t[1]=c*u+f*-s+M*-i-h*-l,t[2]=M*u+f*-l+h*-s-c*-i,t[3]=a[3],t},r.forEach=function(){var t=r.create();return function(a,e,n,r,o,i){var s,l;for(e||(e=4),n||(n=0),l=r?Math.min(r*e+n,a.length):a.length,s=n;l>s;s+=e)t[0]=a[s],t[1]=a[s+1],t[2]=a[s+2],t[3]=a[s+3],o(t,t,i),a[s]=t[0],a[s+1]=t[1],a[s+2]=t[2],a[s+3]=t[3];return a}}(),r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]},r.equals=function(t,a){var e=t[0],r=t[1],o=t[2],i=t[3],s=a[0],l=a[1],u=a[2],h=a[3];return Math.abs(e-s)<=n.EPSILON*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(r-l)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-u)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(i-h)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))},t.exports=r},function(t,a,e){var n=e(1),r={};r.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},r.clone=function(t){var a=new n.ARRAY_TYPE(2);return a[0]=t[0],a[1]=t[1],a},r.fromValues=function(t,a){var e=new n.ARRAY_TYPE(2);return e[0]=t,e[1]=a,e},r.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t},r.set=function(t,a,e){return t[0]=a,t[1]=e,t},r.add=function(t,a,e){return t[0]=a[0]+e[0],t[1]=a[1]+e[1],t},r.subtract=function(t,a,e){return t[0]=a[0]-e[0],t[1]=a[1]-e[1],t},r.sub=r.subtract,r.multiply=function(t,a,e){return t[0]=a[0]*e[0],t[1]=a[1]*e[1],t},r.mul=r.multiply,r.divide=function(t,a,e){return t[0]=a[0]/e[0],t[1]=a[1]/e[1],t},r.div=r.divide,r.ceil=function(t,a){return t[0]=Math.ceil(a[0]),t[1]=Math.ceil(a[1]),t},r.floor=function(t,a){return t[0]=Math.floor(a[0]),t[1]=Math.floor(a[1]),t},r.min=function(t,a,e){return t[0]=Math.min(a[0],e[0]),t[1]=Math.min(a[1],e[1]),t},r.max=function(t,a,e){return t[0]=Math.max(a[0],e[0]),t[1]=Math.max(a[1],e[1]),t},r.round=function(t,a){return t[0]=Math.round(a[0]),t[1]=Math.round(a[1]),t},r.scale=function(t,a,e){return t[0]=a[0]*e,t[1]=a[1]*e,t},r.scaleAndAdd=function(t,a,e,n){return t[0]=a[0]+e[0]*n,t[1]=a[1]+e[1]*n,t},r.distance=function(t,a){var e=a[0]-t[0],n=a[1]-t[1];return Math.sqrt(e*e+n*n)},r.dist=r.distance,r.squaredDistance=function(t,a){var e=a[0]-t[0],n=a[1]-t[1];return e*e+n*n},r.sqrDist=r.squaredDistance,r.length=function(t){var a=t[0],e=t[1];return Math.sqrt(a*a+e*e)},r.len=r.length,r.squaredLength=function(t){var a=t[0],e=t[1];return a*a+e*e},r.sqrLen=r.squaredLength,r.negate=function(t,a){return t[0]=-a[0],t[1]=-a[1],t},r.inverse=function(t,a){return t[0]=1/a[0],t[1]=1/a[1],t},r.normalize=function(t,a){var e=a[0],n=a[1],r=e*e+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=a[0]*r,t[1]=a[1]*r),t},r.dot=function(t,a){return t[0]*a[0]+t[1]*a[1]},r.cross=function(t,a,e){var n=a[0]*e[1]-a[1]*e[0];return t[0]=t[1]=0,t[2]=n,t},r.lerp=function(t,a,e,n){var r=a[0],o=a[1];return t[0]=r+n*(e[0]-r),t[1]=o+n*(e[1]-o),t},r.random=function(t,a){a=a||1;var e=2*n.RANDOM()*Math.PI;return t[0]=Math.cos(e)*a,t[1]=Math.sin(e)*a,t},r.transformMat2=function(t,a,e){var n=a[0],r=a[1];return t[0]=e[0]*n+e[2]*r,t[1]=e[1]*n+e[3]*r,t},r.transformMat2d=function(t,a,e){var n=a[0],r=a[1];return t[0]=e[0]*n+e[2]*r+e[4],t[1]=e[1]*n+e[3]*r+e[5],t},r.transformMat3=function(t,a,e){var n=a[0],r=a[1];return t[0]=e[0]*n+e[3]*r+e[6],t[1]=e[1]*n+e[4]*r+e[7],t},r.transformMat4=function(t,a,e){var n=a[0],r=a[1];return t[0]=e[0]*n+e[4]*r+e[12],t[1]=e[1]*n+e[5]*r+e[13],t},r.forEach=function(){var t=r.create();return function(a,e,n,r,o,i){var s,l;for(e||(e=2),n||(n=0),l=r?Math.min(r*e+n,a.length):a.length,s=n;l>s;s+=e)t[0]=a[s],t[1]=a[s+1],o(t,t,i),a[s]=t[0],a[s+1]=t[1];return a}}(),r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},r.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]},r.equals=function(t,a){var e=t[0],r=t[1],o=a[0],i=a[1];return Math.abs(e-o)<=n.EPSILON*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(r-i)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))},t.exports=r}])}),window.shader=window.shader||{},window.shader.fs="\n  varying mediump vec3 vDirection;\n  uniform mediump float eye;\n  uniform mediump float projection;\n\n  uniform sampler2D uSampler;\n\n  #define PI 3.1415926535897932384626433832795\n\n  mediump vec4 directionToColor(mediump vec3 direction, mediump float eye, mediump float projection) {\n    /*\n    * Input: a direction.  +x = right, +y = up, +z = backward.\n    *        an eye. left = 0, right = 1.\n    *        a projection. see ProjectionEnum in JS file for enum\n    * Output: a color from the video\n    *\n    * Bug alert: the control flow here may screw up texture filtering.\n    */\n\n    mediump float theta = atan(direction.x, -1.0 * direction.z);\n    mediump float phi = atan(direction.y, length(direction.xz));\n\n    /*\n    * The Nexus 7 and the Moto X (and possibly many others) have\n    * a buggy atan2 implementation that screws up when the numerator\n    * (the first argument) is too close to zero.  (The 1e-4 is carefully\n    * chosen: 1e-5 doesn't fix the problem.\n    */\n    if (abs(direction.x) < 1e-4 * abs(direction.z))\n    theta = 0.5*PI * (1.0 - sign(-1.0 * direction.z));\n    if (abs(direction.y) < 1e-4 * length(direction.xz))\n    phi = 0.0;\n\n    // Uncomment to debug the transformations.\n    // return vec4(theta / (2. * PI) + 0.5, phi / (2. * PI) + 0.5, 0., 0.);\n\n    if (projection == 0.) {\n      // Projection == 0: equirectangular projection\n      return texture2D(uSampler, vec2(mod(theta / (2.0*PI), 1.0), phi / PI + 0.5));\n    } else {\n      // Projection == 1: equirectangular top/bottom 3D projection\n      eye = 1. - eye;\n      return texture2D(uSampler, vec2(mod(theta / (2.0*PI), 1.0), ((phi / PI + 0.5) + eye)/ 2.));\n    }\n  }\n\n  void main(void) {\n    gl_FragColor = directionToColor(vDirection, eye, projection);\n  }\n",window.shader=window.shader||{},window.shader.vs="\n  attribute mediump vec2 aVertexPosition;\n\n  uniform mediump mat4 proj_inv;\n\n  varying mediump vec3 vDirection;\n\n  void main(void) {\n    gl_Position = vec4(aVertexPosition, 1.0, 1.0);\n    mediump vec4 projective_direction = proj_inv * gl_Position;\n    vDirection = projective_direction.xyz / projective_direction.w;\n  }\n",function(t){"use strict";var a={getScreenOrientation:function(){switch(window.screen.orientation||window.screen.mozOrientation){case"landscape-primary":return 90;case"landscape-secondary":return-90;case"portrait-secondary":return 180;case"portrait-primary":return 0}if(void 0!==window.orientation)return window.orientation},mat4PerspectiveFromVRFieldOfView:function(t,a,e){var n=Math.tan(t.upDegrees*Math.PI/180),r=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),i=Math.tan(t.rightDegrees*Math.PI/180),s=2/(o+i),l=2/(n+r),u=new Float32Array(16);return u[0]=s,u[4]=0,u[8]=-((o-i)*s*.5),u[12]=0,u[1]=0,u[5]=l,u[9]=(n-r)*l*.5,u[13]=0,u[2]=0,u[6]=0,u[10]=e/(a-e),u[14]=e*a/(a-e),u[3]=0,u[7]=0,u[11]=-1,u[15]=0,u},isFullscreen:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.webkitCurrentFullScreenElement},setCanvasSize:function(t,e){var n,r,o=webVR.getInstance().vrHMD;if(n=window.innerWidth,r=window.innerHeight,o&&"undefined"!=typeof a.isFullscreen()&&a.isFullscreen()){var i=o.getEyeParameters("right").renderRect;t.width=2*i.width,t.height=i.height}else{var s=window.devicePixelRatio||1,l=s/e;t.width===n*l&&t.height===r*l||(t.width=n*l,t.height=r*l)}t.style.width="100%",t.style.height="100%"},getExtension:function(t){return t.substr(t.lastIndexOf(".")+1)},getBaseFilename:function(t){return t.substr(t.lastIndexOf("/")+1)},hasVideoExtension:function(t){var e=a.getExtension(t);return"mp4"===e||"ogg"===e||"webm"===e},getVideoTitle:function(t){return a.hasVideoExtension(t)?a.getBaseFilename(t):t}};t.util=a}(window);var _createClass=function(){function t(t,a){for(var e=0;e<a.length;e++){var n=a[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(a,e,n){return e&&t(a.prototype,e),n&&t(a,n),a}}();!function(t){"use strict";var a=function(){function t(){var a=this;_classCallCheck(this,t),this.deviceAlpha=null,this.deviceGamma=null,this.deviceBeta=null,window.addEventListener("deviceorientation",function(t){a.deviceAlpha=t.alpha,a.deviceGamma=t.gamma,a.deviceBeta=t.beta})}return _createClass(t,[{key:"orientationIsAvailable",value:function(){return null!==this.deviceAlpha}},{key:"rotationQuat",value:function(){if(!this.orientationIsAvailable())return quat.create(1,0,0,0);var t=Math.PI/180,a=this.deviceAlpha*t/2,e=this.deviceBeta*t/2,n=this.deviceGamma*t/2,r=Math.cos(e),o=Math.cos(n),i=Math.cos(a),s=Math.sin(e),l=Math.sin(n),u=Math.sin(a),h=r*o*i-s*l*u;e=s*o*i-r*l*u,n=r*l*i+s*o*u,a=r*o*u+s*l*i;var c=quat.fromValues(e,n,a,h),M=util.getScreenOrientation()*t/2,f=[0,0,-Math.sin(M),Math.cos(M)],m=quat.create();quat.multiply(m,c,f);var d=Math.sqrt(.5);return quat.multiply(m,quat.fromValues(-d,0,0,d),m),m}}]),t}();t.PhoneVR=function(){var t=void 0;return{getInstance:function(){return t||(t=new a),t}}}()}(window);var _createClass=function(){function t(t,a){for(var e=0;e<a.length;e++){var n=a[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(a,e,n){return e&&t(a.prototype,e),n&&t(a,n),a}}(),PlayerControls=function(){function t(a,e){function n(){var t=quat.create(),a=new Float32Array([0,0,0]);return a[0]=180*Math.asin(2*(t[0]*t[2]-t[1]*t[3]))/Math.PI,a[1]=180*Math.atan2(2*(t[0]*t[1]+t[2]*t[3]),1-2*(t[1]*t[1]+t[2]*t[2]))/Math.PI,a}_classCallCheck(this,t),this.video=a,this.canvas=e,this.manualRotateRate=new Float32Array([0,0,0]),this.latlong=n(),this.manualRotation=quat.create(),this.manualControls={a:{index:1,sign:1,active:0},d:{index:1,sign:-1,active:0},w:{index:0,sign:1,active:0},s:{index:0,sign:-1,active:0}},this.mouseMove={x:0,y:0},this.initKeys()}return _createClass(t,[{key:"initKeys",value:function(){this.onKeyPress=this.onKeyPress.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),document.addEventListener("keydown",this.onKeyPress),document.addEventListener("keyup",this.onKeyPress),document.addEventListener("mouseup",this.onMouseUp),this.canvas.addEventListener("mousedown",this.onMouseDown)}},{key:"onMouseDown",value:function(t){this.canvas.addEventListener("mousemove",this.onMouseMove),this.mouseMove.X=t.clientX,this.mouseMove.y=t.clientY,t.preventDefault()}},{key:"onMouseUp",value:function(){this.canvas.removeEventListener("mousemove",this.onMouseMove),this.manualRotateRate=quat.create()}},{key:"onMouseMove",value:function(t){var a=t.clientX-this.mouseMove.X,e=t.clientY-this.mouseMove.y,n=Math.min(this.canvas.width,this.canvas.height);this.manualRotateRate[0]+=2*-e/n,this.manualRotateRate[1]+=2*-a/n,this.mouseMove.X=t.clientX,this.mouseMove.y=t.clientY}},{key:"onKeyPress",value:function(t){function a(){"keydown"!==t.type&&(webVR.getInstance().vrSensor?webVR.getInstance().vrSensor.zeroSensor():quat.invert(n.manualRotation,PhoneVR.getInstance().rotationQuat()))}function e(t,a){var e=n.manualControls[String.fromCharCode(t.keyCode).toLowerCase()];e&&(1===a&&e.active||a===-1&&!e.active||(e.active=1===a,n.manualRotateRate[e.index]+=a*e.sign))}var n=this;switch(String.fromCharCode(t.charCode)){case"z":a();break;default:e(t,"keydown"===t.type?1:-1)}}},{key:"destroy",value:function(){document.removeEventListener("keydown",this.onKeyPress),document.removeEventListener("keyup",this.onKeyPress),document.removeEventListener("mouseup",this.onMouseUp),this.canvas.removeEventListener("mousedown",this.onMouseDown),this.canvas.removeEventListener("mousemove",this.onMouseMove),this.video=null,this.canvas=null}}]),t}(),_createClass=function(){function t(t,a){for(var e=0;e<a.length;e++){var n=a[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(a,e,n){return e&&t(a.prototype,e),n&&t(a,n),a}}(),PlayerWebGL=function(){function t(a,e){function n(){return i.canvas.getContext("webgl")||i.canvas.getContext("experimental-webgl")}function r(){i.gl.clearColor(0,0,0,0),i.gl.clearDepth(1),i.gl.disable(i.gl.DEPTH_TEST),o()}function o(){var t={fragmentShaderName:"fs",vertexShaderName:"vs",attributes:["aVertexPosition"],uniforms:["uSampler","eye","projection","proj_inv"]};i.program=i.gl.createProgram(),i.gl.attachShader(i.program,i.getShaderByName(t.vertexShaderName,"x-vertex")),i.gl.attachShader(i.program,i.getShaderByName(t.fragmentShaderName,"x-fragment")),i.gl.linkProgram(i.program),i.gl.getProgramParameter(i.program,i.gl.LINK_STATUS)||alert("Unable to initialize the shader program: "+i.gl.getProgramInfoLog(i.program)),i.gl.useProgram(i.program),i.attributes={};for(var a=0;a<t.attributes.length;a++){var e=t.attributes[a];i.attributes[e]=i.gl.getAttribLocation(i.program,e),i.gl.enableVertexAttribArray(i.attributes[e])}i.uniforms={};for(var n=0;n<t.uniforms.length;n++){var r=t.uniforms[n];i.uniforms[r]=i.gl.getUniformLocation(i.program,r),i.gl.enableVertexAttribArray(i.attributes[r])}}_classCallCheck(this,t);var i=this;this.eyeCount=1,this.video=a,this.canvas=e,this.gl=null,this.positionsBuffer=null,this.projection=0,this.controls=null,this.texture=null,this.verticesIndexBuffer=null,this.timing={showTiming:!1,frameTime:0,prevFrameTime:0,canvasResized:0,textureLoaded:0,start:0,end:0,framesSinceIssue:0};try{this.gl=n()}catch(s){}return this.gl?void r():void alert("Unable to initialize WebGL. Your browser may not support it.")}return _createClass(t,[{key:"drawScene",value:function(t){if(this.timing.frameTime=t,this.timing.showTiming&&(this.timing.start=performance.now()),util.setCanvasSize(this.canvas,this.getBackingStorePixelRatio()),this.timing.showTiming&&(this.timing.canvasResized=performance.now()),this.updateTexture(),this.timing.showTiming&&(this.timing.textureLoaded=performance.now()),this.timing.prevFrameTime){var a=.001*(this.timing.frameTime-this.timing.prevFrameTime);this.controls.latlong[0]+=this.controls.manualRotateRate[0]*a*90,this.controls.latlong[1]+=this.controls.manualRotateRate[1]*a*90;var e=Math.PI/180/2,n=quat.fromValues(Math.cos(e*this.controls.latlong[1]),0,-Math.sin(e*this.controls.latlong[1]),0),r=quat.fromValues(Math.cos(e*this.controls.latlong[0]),0,0,-Math.sin(e*this.controls.latlong[0]));quat.multiply(this.controls.manualRotation,n,r);
}var o=mat4.create(),i=webVR.getInstance().vrHMD;if(i){var s=i.getEyeParameters("left"),l=i.getEyeParameters("right");o=util.mat4PerspectiveFromVRFieldOfView(s.recommendedFieldOfView,.1,10),this.drawEye("left",o),o=util.mat4PerspectiveFromVRFieldOfView(l.recommendedFieldOfView,.1,10),this.drawEye("right",o)}else{var u=void 0;2===this.eyeCount?(u=this.canvas.width/2/this.canvas.height,mat4.perspective(o,Math.PI/2,u,.1,10),this.drawEye("left",o),this.drawEye("right",o)):(u=this.canvas.width/this.canvas.height,mat4.perspective(o,Math.PI/2,u,.1,10),this.drawEye("both",o))}this.timing.showTiming&&(this.gl.finish(),this.timing.end=performance.now(),this.timing.end-this.timing.frameTime>20?(console.log(this.timing.framesSinceIssue+" Frame time: "+(this.timing.start-this.timing.frameTime)+"ms animation frame lag + "+(this.timing.canvasResized-this.timing.start)+"ms canvas resized + "+(this.timing.textureLoaded-this.timing.canvasResized)+"ms to load texture + "+(this.timing.end-this.timing.textureLoaded)+"ms = "+(this.timing.end-this.timing.frameTime)+"ms"),this.timing.framesSinceIssue=0):this.timing.framesSinceIssue++),this.play(),this.timing.prevFrameTime=this.timing.frameTime}},{key:"drawEye",value:function(t,a){function e(){var t=quat.create(),a=quat.create();if(webVR.getInstance().vrSensor){var e=webVR.getInstance().vrSensor.getState();null!==e&&null!==e.orientation&&"undefined"!=typeof e.orientation&&0!==e.orientation.x&&0!==e.orientation.y&&0!==e.orientation.z&&0!==e.orientation.w&&(a=new Float32Array([e.orientation.x,e.orientation.y,e.orientation.z,e.orientation.w]))}else a=PhoneVR.getInstance().rotationQuat();return quat.multiply(t,n.controls.manualRotation,a),t}var n=this;this.gl.useProgram(this.program),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionsBuffer),this.gl.vertexAttribPointer(this.attributes.aVertexPosition,2,this.gl.FLOAT,!1,0,0),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.uniform1i(this.uniforms.uSampler,0),this.gl.uniform1f(this.uniforms.eye,"right"===t?1:0),this.gl.uniform1f(this.uniforms.projection,this.projection);var r=mat4.create(),o=e();mat4.fromQuat(r,o);var i=mat4.create();mat4.invert(i,a);var s=mat4.create();mat4.multiply(s,r,i),this.gl.uniformMatrix4fv(this.uniforms.proj_inv,!1,s),"left"===t&&this.gl.viewport(0,0,this.canvas.width/2,this.canvas.height),"right"===t&&this.gl.viewport(this.canvas.width/2,0,this.canvas.width/2,this.canvas.height),"both"===t&&this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.verticesIndexBuffer),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}},{key:"play",value:function(){var t=this;this.reqAnimFrameID=requestAnimationFrame(function(a){t.drawScene(a)})}},{key:"stop",value:function(){cancelAnimationFrame(this.reqAnimFrameID)}},{key:"getBackingStorePixelRatio",value:function(){return this.gl.webkitBackingStorePixelRatio||this.gl.mozBackingStorePixelRatio||this.gl.msBackingStorePixelRatio||this.gl.oBackingStorePixelRatio||this.gl.backingStorePixelRatio||1}},{key:"initBuffers",value:function(){this.positionsBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionsBuffer);var t=[-1,-1,1,-1,1,1,-1,1];this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.verticesIndexBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.verticesIndexBuffer);var a=[0,1,2,0,2,3];this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),this.gl.STATIC_DRAW)}},{key:"initTextures",value:function(){this.texture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"updateTexture",value:function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGB,this.gl.RGB,this.gl.UNSIGNED_BYTE,this.video),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"setProjection",value:function(t){function a(t){switch(t.toLowerCase()){case"mono":case"2d":case"0":case"equirectangular":return 0;default:return 1}}this.projection=a(t)}},{key:"setControls",value:function(t){this.controls=t}},{key:"setEyeCount",value:function(t){this.eyeCount=t}},{key:"getShaderByName",value:function(t,a){var e="";if(!window.shader||!window.shader[t])return null;var n=window.shader[t];if("x-fragment"===a)e=this.gl.createShader(this.gl.FRAGMENT_SHADER);else{if("x-vertex"!==a)return null;e=this.gl.createShader(this.gl.VERTEX_SHADER)}return this.gl.shaderSource(e,n),this.gl.compileShader(e),this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS)?e:(alert("An error occurred compiling the shaders: "+this.gl.getShaderInfoLog(e)),null)}},{key:"destroy",value:function(){this.stop(),this.video=null,this.canvas=null,this.controls=null}}]),t}();!function(t){"use strict";var a=function e(){_classCallCheck(this,e);this.vrHMD=null,this.vrSensor=null,navigator.getVRDevices&&navigator.getVRDevices().then(webVR.vrDeviceCallback)};t.webVR=function(){var t=void 0;return{getInstance:function(){return t||(t=new a),t}}}()}(window);var _createClass=function(){function t(t,a){for(var e=0;e<a.length;e++){var n=a[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(a,e,n){return e&&t(a.prototype,e),n&&t(a,n),a}}(),EleVRPlayer=function(){function t(a){var e=this;_classCallCheck(this,t),this.video=a,this.canvas=document.createElement("canvas"),this.canvas.classList=this.video.classList,this.canvas.classList.add("elevr"),this.video.style.display="none",this.video.parentNode.insertBefore(this.canvas,this.video),this.webGL=new PlayerWebGL(this.video,this.canvas),this.webGL.gl&&(util.setCanvasSize(this.canvas,this.webGL.getBackingStorePixelRatio()),this.controls=new PlayerControls(this.video,this.canvas),this.webGL.setControls(this.controls),this.webGL.initBuffers(),this.webGL.initTextures(),this.start=this.start.bind(this),this.video.addEventListener("canplaythrough",this.start),this.setEyeCount=function(t){return e.webGL.setEyeCount(t)})}return _createClass(t,[{key:"start",value:function(){this.webGL.play()}},{key:"destroy",value:function(){this.webGL.destroy(),this.controls.destroy(),this.video.removeEventListener("canplaythrough",this.start),this.video.parentNode.removeChild(this.canvas),this.canvas=null,this.video.style.display="",this.video=null}}]),t}();window.EleVRPlayer=EleVRPlayer;
//# sourceMappingURL=player.min.js.map
